<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <title>History of Now</title>
    <link rel="stylesheet" href="style3.css" />
    <link rel="stylesheet" href="./vendor/antikythera/css/fonts.css" />
    <link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
  </head>

  <body>
    <div class="container">
      <antikythera-menu
        entry="historyofnow"
        environment="production"
        theme="dark"
      ></antikythera-menu>
      <!-- Left Half: 3D Scene and Controls -->
      <div class="scene-container">
        <!-- Logarithmic scales on both sides -->
        <div class="log-scale log-scale-left"></div>
        <div class="log-scale log-scale-right"></div>

        <div class="ui-buttons">
          <img id="toggle-controls" src="assets/ui.png" alt="Toggle Controls" />
          <div class="controls-container">
            <div class="ui-section">
              <div class="text-controls">
                <label for="x-rotation-slider">View Angle</label>
              </div>
              <div>
                <input
                  type="range"
                  id="x-rotation-slider"
                  min="-1.57"
                  max="1.57"
                  step="0.01"
                  value="0"
                />
              </div>
            </div>

            <div class="ui-section">
              <div class="text-controls">
                <label for="scale-slider">Time Scale</label>
              </div>
              <div>
                <input
                  type="range"
                  id="scale-slider"
                  min=".0001"
                  max="12"
                  value="5"
                  step="0.1"
                />
              </div>
            </div>

            <div class="ui-section">
              <div class="text-controls">Dark Mode</div>
              <label class="switch">
                <input type="checkbox" id="dark-mode-toggle" />
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>

        <!-- Tooltip -->
        <div class="tooltip" id="tooltip"></div>

        <!-- Three.js Canvas -->
        <div id="threejs-container"></div>
      </div>
      <!-- Closed scene-container correctly -->
      <div class="controls-container"></div>
      <img
        id="fullscreen-icon"
        src="assets/fullscreen.png"
        alt="Fullscreen Icon"
        class="fullscreen-icon"
      />

      <!-- Right Half: Essay -->
      <div id="essay-content" class="essay-container"></div>
      <!-- Correctly closed -->
    </div>

    <!-- Include Three.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <!-- Include non-module versions of FontLoader and TextGeometry -->
    <script src="https://threejs.org/examples/js/loaders/FontLoader.js"></script>
    <script src="https://threejs.org/examples/js/geometries/TextGeometry.js"></script>

    <!-- Include Line2 related scripts -->
    <script src="https://threejs.org/examples/js/lines/Line2.js"></script>
    <script src="https://threejs.org/examples/js/lines/LineMaterial.js"></script>
    <script src="https://threejs.org/examples/js/lines/LineGeometry.js"></script>

    <!-- Include TWEEN.js for smooth animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <!-- Your main script for Option 2 -->
    <script src="option4.js"></script>
    <script>
      // We need to polyfill process (since we are not in a node-js environment)
      window.process = { env: { NODE_ENV: "production" } };
    </script>
    <script type="module">
      import { Antikythera } from "./vendor/antikythera/antikythera.js";

      document.addEventListener("DOMContentLoaded", async () => {
        const antikythera = new Antikythera({
          entry: "historyofnow",
        });
        window.article = await antikythera.getEntry({ textStyle: "html" });
        document.getElementById("article-title").textContent =
          window.article?.entry?.title;
        document.getElementById("article-content").innerHTML =
          window.article?.entry?.content;

        // We call this manually since article content is fetched
        // In the case where the article content is local this is not necessary (see docs for more info)
        await antikythera.detectAnnotations();
      });
    </script>
  </body>
</html>
